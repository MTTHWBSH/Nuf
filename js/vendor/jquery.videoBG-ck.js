/**
 * @preserve Copyright 2011 Syd Lawrence ( www.sydlawrence.com ).
 * Version: 0.2
 *
 * Licensed under MIT and GPLv2.
 *
 * Usage: $('body').videoBG(options);
 *
 */(function(e){e.fn.videoBG=function(t,n){var n={};if(typeof t=="object")n=e.extend({},e.fn.videoBG.defaults,t);else{if(!!t)return e(t).videoBG(n);n=e.fn.videoBG.defaults}var r=e(this);if(!r.length)return;(r.css("position")=="static"||!r.css("position"))&&r.css("position","relative");n.width==0&&(n.width=r.width());n.height==0&&(n.height=r.height());var i=e.fn.videoBG.wrapper();i.height(n.height).width(n.width);if(n.textReplacement){n.scale=!0;r.width(n.width).height(n.height).css("text-indent","-9999px")}else i.css("z-index",n.zIndex+1);i.html(r.clone(!0));var s=e.fn.videoBG.video(n);if(n.scale){i.height(n.height).width(n.width);s.height(n.height).width(n.width)}r.html(i);r.append(s);return s.find("video")[0]};e.fn.videoBG.setFullscreen=function(t){var n=e(window).width(),r=e(window).height();t.css("min-height",0).css("min-width",0);t.parent().width(n).height(r);if(n/r>t.aspectRatio){t.width(n).height("auto");var i=t.height(),s=(i-r)/2;s<0&&(s=0);t.css("top",-s)}else{t.width("auto").height(r);var o=t.width(),s=(o-n)/2;s<0&&(s=0);t.css("left",-s);if(s===0)var u=setTimeout(function(){e.fn.videoBG.setFullscreen(t)},500)}e("body > .videoBG_wrapper").width(n).height(r)};e.fn.videoBG.video=function(t){e("html, body").scrollTop(-1);var n=e("<div/>");n.addClass("videoBG").css("position",t.position).css("z-index",t.zIndex).css("top",0).css("left",0).css("height",t.height).css("width",t.width).css("opacity",t.opacity).css("overflow","hidden");var r=e("<video/>");r.css("position","absolute").css("z-index",t.zIndex).attr("poster",t.poster).css("top",0).css("left",0).css("min-width","100%").css("min-height","100%");t.autoplay&&r.attr("autoplay",t.autoplay);if(t.fullscreen){r.bind("canplay",function(){r.aspectRatio=r.width()/r.height();e.fn.videoBG.setFullscreen(r)});var i;e(window).resize(function(){clearTimeout(i);i=setTimeout(function(){e.fn.videoBG.setFullscreen(r)},100)});e.fn.videoBG.setFullscreen(r)}var s=r[0];if(t.loop){loops_left=t.loop;r.bind("ended",function(){loops_left&&s.play();loops_left!==!0&&loops_left--})}r.bind("canplay",function(){t.autoplay&&s.play()});e.fn.videoBG.supportsVideo()&&(e.fn.videoBG.supportType("webm")?r.attr("src",t.webm):e.fn.videoBG.supportType("mp4")?r.attr("src",t.mp4):r.attr("src",t.ogv));var o=e("<img/>");o.attr("src",t.poster).css("position","absolute").css("z-index",t.zIndex).css("top",0).css("left",0).css("min-width","100%").css("min-height","100%");e.fn.videoBG.supportsVideo()?n.html(r):n.html(o);if(t.textReplacement){n.css("min-height",1).css("min-width",1);r.css("min-height",1).css("min-width",1);o.css("min-height",1).css("min-width",1);n.height(t.height).width(t.width);r.height(t.height).width(t.width);o.height(t.height).width(t.width)}e.fn.videoBG.supportsVideo()&&s.play();return n};e.fn.videoBG.supportsVideo=function(){return document.createElement("video").canPlayType};e.fn.videoBG.supportType=function(t){if(!e.fn.videoBG.supportsVideo())return!1;var n=document.createElement("video");switch(t){case"webm":return n.canPlayType('video/webm; codecs="vp8, vorbis"');case"mp4":return n.canPlayType('video/mp4; codecs="avc1.42E01E, mp4a.40.2"');case"ogv":return n.canPlayType('video/ogg; codecs="theora, vorbis"')}return!1};e.fn.videoBG.wrapper=function(){var t=e("<div/>");t.addClass("videoBG_wrapper").css("top",0).css("left",0);return t};e.fn.videoBG.defaults={mp4:"",ogv:"",webm:"",poster:"",autoplay:!0,loop:!0,scale:!1,position:"absolute",opacity:1,textReplacement:!1,zIndex:0,width:0,height:0,fullscreen:!1,imgFallback:!0}})(jQuery);